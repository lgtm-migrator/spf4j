<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/apt/index.apt at 2021-11-10
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20211110" />
    <meta http-equiv="Content-Language" content="en" />
    <title>spf4j-zel &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>ZEL Expression Language</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2021-11-10<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 8.9.3-SNAPSHOT</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="./" title="ZEL">ZEL</a></li>
      <li class="pull-right"><a href=".." title="SPF4J">SPF4J</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Main Menu</li>
    <li class="active"><a href="#"><span class="none"></span>Introduction</a></li>
    <li><a href="avrodoc.html" title="Avro Schemas"><span class="none"></span>Avro Schemas</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
    <ul class="nav nav-list">
    <li><a href="integration.html" title="Continuous Integration"><span class="none"></span>Continuous Integration</a></li>
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a></li>
    <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a></li>
    <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a></li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a></li>
    <li class="active"><a href="#"><span class="none"></span>About</a></li>
    <li><a href="issue-tracking.html" title="Issue Tracking"><span class="none"></span>Issue Tracking</a></li>
    <li><a href="license.html" title="Project License"><span class="none"></span>Project License</a></li>
    <li><a href="mail-lists.html" title="Mailing Lists"><span class="none"></span>Mailing Lists</a></li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a></li>
    <li><a href="plugins.html" title="Project Plugins"><span class="none"></span>Project Plugins</a></li>
    <li><a href="team-list.html" title="Project Team"><span class="none"></span>Project Team</a></li>
    <li><a href="source-repository.html" title="Source Repository"><span class="none"></span>Source Repository</a></li>
    <li><a href="project-summary.html" title="Project Summary"><span class="none"></span>Project Summary</a></li>
    </ul>
</li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="The_Z_Language"></a>The Z Language</h2>
<p>Scope: A simple but easy to extend language for writing mathematical expressions that slowly evolves into a general purpose programming language with a focus on concurrency and <a class="externalLink" href="http://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/)">color-less functions</a>.</p>
<p>Now there are a few other projects out there that do a similar job, here is what it's different (or not :-) ) about this particular implementation:</p>
<p>1. &quot;Improved&quot; Asynchronous programming / coroutines. Zel attempts to bridge the sync and async async divide by implementing a stack based virtual machine, where the the stack elements are: Either&lt;Object, Future&lt;Object&gt;&gt;. What this means at a higher level that a function like: &quot;function(int value) { ... print(value)..}&quot; can be called either with a int or a Future&lt;int&gt;. Future.get gets invoked when needed (Lazy). (when calling system calls... like print in the example above). Also Functions can be executed async automatically by the VM or not. We let the VMs free our objects, maybe it is time to let them execute functions asynchronously... Zel is an attempt to play with the idea...</p>
<p>2. Support for deterministic functions, (aka memorization). Execution results will be cached for deterministic functions.</p>
<p>3. Integer mathematical operations do not overflow. (types are upgraded: int -&gt; long -&gt; BigInteger) Real number representation can be used seamlessly with decimal or binary representation. (BigDecimal or double64)</p>
<p>4. ZEL uses the last value out principle, expressions will return the last evaluated expression. There is a return keyword that can also be used but it is optional.</p>
<p>5. Expressions are compiled providing decent execution performance. The concurrency features in Zel enable you to write concurrent code that is easier to understand.</p>
<p>6. Implemented using javaCC</p>
<p>7. Python style type system, yuck. (Planning to improve to a proper strong type system)</p>
<p>8. Apache and LGPL license.</p>
<p>Here are some examples:</p>
<div class="source"><pre class="prettyprint">
EX1:    // fibonacci recursive definition executes in O(n)
        // deterministic function results are automatically memorized
        
        func det fib (x) { fib(x-1) + fib(x-2) }
        fib(0) = 0; // memorize result
        fib(1) = 1; // memorize result
        out(fib(200))

EX1:    // ZEL mathematical expressions in java code

        Program prog = Program.compile(&quot;1+5*4/(1+1)&quot;);
        Number result = (Number) prog.execute();

EX2:    // formulas with decimal numbers can be written easer than directly in java
        // decimal numbers are represented with BigDecimal by default in zel
        // regular binary floating point representation can be used as well with &quot;d&quot; suffix.

        BigDecimal result = (BigDecimal) Program.compile(&quot;use dec 128; (1.0/3) * 3 + (1 - 1.0/3*3)&quot;).execute();

EX3:    // java integration, java objects are supported just like in java:

        Program prog = Program.compile(&quot;a.toString().substring(0, 1 + 1)&quot;, &quot;a&quot;);
        String result = (String) prog.execute(100);

EX4:    // ZEL mathematical expressions in java code

        Program prog = Program.compile(&quot;1+5*4/(1+1)&quot;);
        Number result = (Number) prog.execute();
 

EX5:    // Async programming.
        // Zel function invocations are async by default.

        replica = func async (x) {
            sleep random() * 1000;
            out(x, &quot; finished\n&quot;);
            return x
        };
        out(first(replica(1), replica(2), replica(3)), &quot; finished first\n&quot;); // output result of first invocation that finishes

EX6:    // Explicit ASync function execution.
        // Java method invocation are sync by default
        // using &amp; postfix operator you can call any function async
        // java example:

        private static class TestF {
            public static int f(final int a, final int b) throws InterruptedException {
                Thread.sleep(1000);
                return a + b;
            }
        }
    
        String prog = &quot;f(f(1, 2)&amp;,f(3, 4)&amp;)&amp;&quot;; // execute f asynchronously.
        Number result = (Number) Program.compile(prog, &quot;f&quot;).execute(new JavaMethodCall(TestF.class, &quot;f&quot;));



EX7:    // Async programming, parallel PI
        // functions can be declared to be executed sync or async
        // currently all functions declared in ZEL are async by default
        // except when the function result is discarded (not assigned to a variable)
        // All other function calls are sync by default
        // async execution can be forced with &amp; postfix operator

        func piPart(s, x) {
            term = func sync (k) {4 * (-1 ** k) / (2d * k + 1)};
            for i = s; i &lt; x; i++ {
              parts[i] = term(i) 
            };

            for result = 0, i = s; i &lt; x; i++ {
              result = result + parts[i] 
            };
            return result
        };

        pi = func (x, breakup) {
            range = x / breakup;
            l = breakup - 1;
            for i = 0, result = 0, k = 0; i &lt; l; i++ {
              part[i] = piPart(k, k + range);
              k = k + range
            };
            part[i] = piPart(k, x); // async call
            for i = 0, result = 0; i &lt; breakup; i = i + 1 {
               result = result + part[i] 
            };
            return result
        };
        pi(x, 5)

EX8:    // Channels!
        // You can comunicate with channels between zel coroutines. 

        ch = channel();
        func prod(ch) { for i = 0; i &lt; 100 ; i++ { ch.write(i) }; ch.close()};
        func cons(ch, nr) {
            sum = 0;
            for v = ch.read(); v != EOF; v = ch.read() {
                out(v, &quot;,&quot;); sum++ 
            };
            out(&quot;fin(&quot;, nr, &quot;,&quot;, sum, &quot;)&quot;) 
        };
        prod(ch)&amp;; // start producer
        for i = 0; i &lt; 10; i++ { cons(ch, i)&amp; } //start consumers

EX9:    // Parallel sort!

        func qSortP(x, start, end) {
          l = end - start;
          if l &lt; 2 {
            return
          };
          pidx = start + l / 2;
          pivot = x[pidx];
          lm1  = end - 1;
          x[pidx] &lt;-&gt; x[lm1];
          npv = start;
          for i = start; i &lt; lm1; i++ {
            if x[i] &lt; pivot {
              x[npv] &lt;-&gt; x[i];
              npv ++
            }
          };
          x[npv] &lt;-&gt; x[lm1];
          qSortP(x, start, npv)&amp;;
          qSortP(x, npv + 1, end)&amp;
        };

        qSortP(x, 0, x.length)

  EX10: // multi-var assignement support

        func minmax (arr) {
            mi = arr[0]; ma = mi;
            for i=1; i &lt; arr.length; i++ {
               v = arr[i];
               if v &gt; ma {
                  ma = v
               } else if v &lt; mi {
                  mi = v
               }
            };
            ret {mi, ma}
         };
         x = {1, 2, 3, 8, 0};
         _min, _max = minmax(x); // multi var assignement
         out(_min, _max); 


   EX11: /**
          * Sleep sort implementation in ZEL :-)
          * this takes advantage of the concurrency facilities available in ZEL.
          * Sleep values are multiplied by 10 due to scheduler precision.
          */

        func sleepSort(x) {
          l = x.length;
          if l &lt;= 0 {
            return x
          };
          resChan = channel();
          max = x[0];
          sl = func (x, ch) {sleep x * 10; ch.write(x)};
          sl(max, resChan)&amp;;
          for i = 1; i &lt; l; i++ {
            val = x[i]; 
            sl(val, resChan)&amp;;
            if (val &gt; max) {
              max = val
            }
          };
          sleep (max + 1) * 10;
          resChan.close();
          for c = resChan.read(), i = 0; c != EOF; c = resChan.read(), i++ {
             x[i] = c
          };
          return x
        };

</pre></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2021
<a href="http://www.spf4j.org">SPF4J</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
